<!DOCTYPE html>
<html>
<head>
    <title>Department Management Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h2>Department Management Test</h2>
    <button onclick="testDepartmentAPI()" class="btn btn-primary">Test Department API</button>
    <div id="result" class="mt-3"></div>
</div>

<script>
async function testDepartmentAPI() {
    const resultDiv = document.getElementById('result');
    
    try {
        // Test GET departments
        const response = await fetch('/api/admin/departments', {
            credentials: 'include'
        });
        
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
            resultDiv.innerHTML = `
                <div class="alert alert-success">
                    <h5>API Test Successful!</h5>
                    <p>Found ${data.data.departments.length} departments:</p>
                    <ul>
                        ${data.data.departments.map(dept => 
                            `<li><strong>${dept.name}</strong> - ${dept.description || 'No description'} 
                             (${dept.doctor_count || 0} doctors, Active: ${dept.is_active})</li>`
                        ).join('')}
                    </ul>
                </div>
            `;
        } else {
            resultDiv.innerHTML = `<div class="alert alert-warning">API returned: ${data.message}</div>`;
        }
    } catch (error) {
        resultDiv.innerHTML = `<div class="alert alert-danger">Error: ${error.message}</div>`;
    }
}
</script>
</body>
</html>